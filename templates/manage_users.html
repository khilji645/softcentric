{% extends "base.html" %}
{% block content %}
<h3>Manage Users</h3>

<!-- Add New User Button & Collapsible Form -->
<button class="btn btn-success mb-3" type="button" data-bs-toggle="collapse" data-bs-target="#addUserForm">
    Add New User
</button>

<div class="collapse mb-3" id="addUserForm">
    <div class="card card-body shadow-sm">
        <form method="POST">
            <div class="row g-2">
                <div class="col-md-4">
                    <input type="text" name="username" class="form-control" placeholder="Username" required>
                </div>
                <div class="col-md-4">
                    <input type="password" name="password" class="form-control" placeholder="Password" required>
                </div>
                <div class="col-md-3">
                    <select name="role" class="form-select" required>
                        <option value="">Select Role</option>
                        <option value="admin">Admin</option>
                        <option value="user">User</option>
                    </select>
                </div>
                <div class="col-md-1 d-grid">
                    <button type="submit" class="btn btn-primary">Add</button>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Users Table -->
<table class="table table-bordered table-hover">
    <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Role</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for user in users %}
        <tr>
            <td>{{ loop.index }}</td>
            <td>{{ user.username }}</td>
            <td>{{ user.role }}</td>
            <td>
                <a href="{{ url_for('edit_user', username=user.username) }}" class="btn btn-sm btn-primary">Edit</a>
                <a href="{{ url_for('delete_user', username=user.username) }}" class="btn btn-sm btn-danger"
                   onclick="return confirm('Are you sure you want to delete this user?');">Delete</a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
